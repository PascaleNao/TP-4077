{"ast":null,"code":"// src/api/medicalApi.js\nimport axios from 'axios';\n\n// Définir l'URL de base pour simplifier les appels\nconst API_URL = 'http://localhost:5000/api'; // *AJUSTEMENT NÉCESSAIRE* : Assurez-vous que le port correspond à votre serveur backend\n\nconst medicalApi = axios.create({\n  baseURL: API_URL,\n  headers: {\n    'Content-Type': 'application/json'\n  }\n});\n\n// Intercepteur pour ajouter le Token JWT à toutes les requêtes sécurisées\nmedicalApi.interceptors.request.use(config => {\n  const token = localStorage.getItem('token');\n  if (token) {\n    config.headers.Authorization = `Bearer ${token}`;\n  }\n  return config;\n}, error => {\n  return Promise.reject(error);\n});\n\n// Fonctions d'authentification\nexport const login = (email, password, role) => {\n  const endpoint = role === 'patient' ? '/patient/login' : '/medecin/login'; // Routes déduites de votre backend (patientRoutes.js et medecinRoutes.js non fournis mais implicites)\n  const data = {\n    email,\n    mot_de_passe: password\n  }; // Utilisez le nom de champ du backend\n  return medicalApi.post(endpoint, data);\n};\nexport const registerPatient = patientData => {\n  return medicalApi.post('/patient/register', patientData);\n};\n\n// Fonctions Dossier Patient\nexport const fetchPatientDossier = () => {\n  // Patient: GET /api/dossier/dossier\n  return medicalApi.get('/dossier/dossier');\n};\nexport const getPatientProfile = () => {\n  // Cette route utilise le token d'authentification (géré par votre instance axios/medicalApi)\n  return medicalApi.get('/patient/profile');\n};\n\n// Fonctions Médecin\nexport const searchPatients = searchQuery => {\n  // Medecin: GET /api/medecin/patients/search?nom=...&numero_medical=...\n  const params = new URLSearchParams(searchQuery).toString();\n  return medicalApi.get(`/medecin/patients/search?${params}`);\n};\nexport const fetchDoctorPatientDossier = patientId => {\n  // Medecin: GET /api/medecin/dossier/:patientId\n  return medicalApi.get(`/medecin/dossier/${patientId}`);\n};\nexport const addConsultation = (consultationData, file) => {\n  // Medecin: POST /api/dossier/consultation\n  const formData = new FormData();\n\n  // Ajouter les champs de texte\n  for (const key in consultationData) {\n    formData.append(key, consultationData[key]);\n  }\n\n  // Ajouter le fichier (doit correspondre à 'document' dans Multer)\n  if (file) {\n    formData.append('document', file);\n  }\n\n  // Config pour les requêtes de type multipart/form-data\n  return medicalApi.post('/dossier/consultation', formData, {\n    headers: {\n      'Content-Type': 'multipart/form-data'\n    }\n  });\n};\n\n// NOTE: Cette route est différente de celle du médecin car elle n'utilise pas patientId dans l'URL (le backend connaît l'ID via le token)\nexport const getPatientDossier = () => {\n  return medicalApi.get('/patient/dossier');\n};\nexport const downloadDocument = documentId => {\n  // Patient & Medecin: GET /api/dossier/documents/:documentId\n  return medicalApi.get(`/dossier/documents/${documentId}`, {\n    responseType: 'blob' // Important pour le téléchargement de fichiers\n  });\n};\n\n// src/api/medicalApi.js (Ajouter dans la section 'Fonctions Dossier Patient')\n\nexport const updatePatientProfile = profileData => {\n  // PUT /api/patient/profile (Utilise le token JWT pour identifier le patient)\n  return medicalApi.put('/patient/profile', profileData);\n};\nexport const grantAccess = (medecinId, dateFin) => {\n  return medicalApi.post('/patient/access/grant', {\n    medecinId,\n    dateFin\n  });\n};\nexport const revokeAccess = grantId => {\n  return medicalApi.delete(`/patient/access/revoke/${grantId}`);\n};\nexport const listAccessGrants = () => {\n  return medicalApi.get('/patient/access/list');\n};\nexport default medicalApi;","map":{"version":3,"names":["axios","API_URL","medicalApi","create","baseURL","headers","interceptors","request","use","config","token","localStorage","getItem","Authorization","error","Promise","reject","login","email","password","role","endpoint","data","mot_de_passe","post","registerPatient","patientData","fetchPatientDossier","get","getPatientProfile","searchPatients","searchQuery","params","URLSearchParams","toString","fetchDoctorPatientDossier","patientId","addConsultation","consultationData","file","formData","FormData","key","append","getPatientDossier","downloadDocument","documentId","responseType","updatePatientProfile","profileData","put","grantAccess","medecinId","dateFin","revokeAccess","grantId","delete","listAccessGrants"],"sources":["/home/viviane/TP JIOMEKONG/carnet-frontend/carnet-medical-app/src/api/medicalApi.js"],"sourcesContent":["// src/api/medicalApi.js\nimport axios from 'axios';\n\n// Définir l'URL de base pour simplifier les appels\nconst API_URL = 'http://localhost:5000/api'; // *AJUSTEMENT NÉCESSAIRE* : Assurez-vous que le port correspond à votre serveur backend\n\nconst medicalApi = axios.create({\n    baseURL: API_URL,\n    headers: {\n        'Content-Type': 'application/json',\n    },\n});\n\n// Intercepteur pour ajouter le Token JWT à toutes les requêtes sécurisées\nmedicalApi.interceptors.request.use(config => {\n    const token = localStorage.getItem('token');\n    if (token) {\n        config.headers.Authorization = `Bearer ${token}`;\n    }\n    return config;\n}, error => {\n    return Promise.reject(error);\n});\n\n// Fonctions d'authentification\nexport const login = (email, password, role) => {\n    const endpoint = role === 'patient' ? '/patient/login' : '/medecin/login'; // Routes déduites de votre backend (patientRoutes.js et medecinRoutes.js non fournis mais implicites)\n    const data = { email, mot_de_passe: password }; // Utilisez le nom de champ du backend\n    return medicalApi.post(endpoint, data);\n};\n\nexport const registerPatient = (patientData) => {\n    return medicalApi.post('/patient/register', patientData);\n};\n\n// Fonctions Dossier Patient\nexport const fetchPatientDossier = () => {\n    // Patient: GET /api/dossier/dossier\n    return medicalApi.get('/dossier/dossier');\n};\n\nexport const getPatientProfile = () => {\n    // Cette route utilise le token d'authentification (géré par votre instance axios/medicalApi)\n    return medicalApi.get('/patient/profile');\n};\n\n// Fonctions Médecin\nexport const searchPatients = (searchQuery) => {\n    // Medecin: GET /api/medecin/patients/search?nom=...&numero_medical=...\n    const params = new URLSearchParams(searchQuery).toString();\n    return medicalApi.get(`/medecin/patients/search?${params}`);\n};\n\nexport const fetchDoctorPatientDossier = (patientId) => {\n    // Medecin: GET /api/medecin/dossier/:patientId\n    return medicalApi.get(`/medecin/dossier/${patientId}`);\n};\n\nexport const addConsultation = (consultationData, file) => {\n    // Medecin: POST /api/dossier/consultation\n    const formData = new FormData();\n\n    // Ajouter les champs de texte\n    for (const key in consultationData) {\n        formData.append(key, consultationData[key]);\n    }\n\n    // Ajouter le fichier (doit correspondre à 'document' dans Multer)\n    if (file) {\n        formData.append('document', file);\n    }\n\n    // Config pour les requêtes de type multipart/form-data\n    return medicalApi.post('/dossier/consultation', formData, {\n        headers: {\n            'Content-Type': 'multipart/form-data',\n        },\n    });\n};\n\n// NOTE: Cette route est différente de celle du médecin car elle n'utilise pas patientId dans l'URL (le backend connaît l'ID via le token)\nexport const getPatientDossier = () => {\n    return medicalApi.get('/patient/dossier');\n};\n\nexport const downloadDocument = (documentId) => {\n    // Patient & Medecin: GET /api/dossier/documents/:documentId\n    return medicalApi.get(`/dossier/documents/${documentId}`, {\n        responseType: 'blob', // Important pour le téléchargement de fichiers\n    });\n};\n\n// src/api/medicalApi.js (Ajouter dans la section 'Fonctions Dossier Patient')\n\nexport const updatePatientProfile = (profileData) => {\n    // PUT /api/patient/profile (Utilise le token JWT pour identifier le patient)\n    return medicalApi.put('/patient/profile', profileData);\n};\n\nexport const grantAccess = (medecinId, dateFin) => {\n    return medicalApi.post('/patient/access/grant', { medecinId, dateFin });\n};\n\nexport const revokeAccess = (grantId) => {\n    return medicalApi.delete(`/patient/access/revoke/${grantId}`);\n};\n\nexport const listAccessGrants = () => {\n    return medicalApi.get('/patient/access/list');\n};\n\nexport default medicalApi;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}