{"ast":null,"code":"var _jsxFileName = \"/home/viviane/TP JIOMEKONG/carnet-frontend/carnet-medical-app/src/pages/PatientArea.jsx\",\n  _s = $RefreshSig$();\n// src/pages/PatientArea.jsx\nimport React, { useState, useEffect } from 'react';\nimport { useAuth } from '../context/AuthContext';\nimport { fetchPatientDossier, downloadDocument } from '../api/medicalApi';\nimport DossierDetails from '../components/patient/DossierDetails';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst PatientArea = () => {\n  _s();\n  var _dossier$patient, _dossier$patient2;\n  const {\n    user\n  } = useAuth();\n  const [dossier, setDossier] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  useEffect(() => {\n    const loadDossier = async () => {\n      try {\n        const res = await fetchPatientDossier();\n        setDossier(res.data);\n        setLoading(false);\n      } catch (err) {\n        console.error(\"Erreur lors de la récupération du dossier:\", err);\n        setError(\"Impossible de charger le dossier médical.\");\n        setLoading(false);\n      }\n    };\n    if (user && user.role === 'patient') {\n      loadDossier();\n    }\n  }, [user]);\n  const handleDownload = async (documentId, fileName) => {\n    try {\n      const res = await downloadDocument(documentId);\n      // Crée un lien temporaire pour télécharger le fichier (blob)\n      const url = window.URL.createObjectURL(new Blob([res.data]));\n      const link = document.createElement('a');\n      link.href = url;\n      link.setAttribute('download', fileName);\n      document.body.appendChild(link);\n      link.click();\n      link.remove();\n      window.URL.revokeObjectURL(url);\n    } catch (error) {\n      alert(\"Erreur lors du téléchargement du document.\");\n      console.error(\"Erreur de téléchargement:\", error);\n    }\n  };\n  if (loading) return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"page-container\",\n    children: \"Chargement du Dossier...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 50,\n    columnNumber: 25\n  }, this);\n  if (error) return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"page-container alert alert-error\",\n    children: error\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 51,\n    columnNumber: 23\n  }, this);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"page-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"Espace Personnel Patient\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: [\"Bienvenue, **\", dossier === null || dossier === void 0 ? void 0 : (_dossier$patient = dossier.patient) === null || _dossier$patient === void 0 ? void 0 : _dossier$patient.prenom, \" \", dossier === null || dossier === void 0 ? void 0 : (_dossier$patient2 = dossier.patient) === null || _dossier$patient2 === void 0 ? void 0 : _dossier$patient2.nom, \"**.\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 13\n    }, this), dossier ? /*#__PURE__*/_jsxDEV(DossierDetails, {\n      dossier: dossier,\n      onDownload: handleDownload\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 17\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"alert alert-error\",\n      children: \"Aucune donn\\xE9e de dossier disponible.\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 17\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 54,\n    columnNumber: 9\n  }, this);\n};\n_s(PatientArea, \"wtmH5wkUvQSCfJq2LM4UfMKLQL4=\", false, function () {\n  return [useAuth];\n});\n_c = PatientArea;\nexport default PatientArea;\nvar _c;\n$RefreshReg$(_c, \"PatientArea\");","map":{"version":3,"names":["React","useState","useEffect","useAuth","fetchPatientDossier","downloadDocument","DossierDetails","jsxDEV","_jsxDEV","PatientArea","_s","_dossier$patient","_dossier$patient2","user","dossier","setDossier","loading","setLoading","error","setError","loadDossier","res","data","err","console","role","handleDownload","documentId","fileName","url","window","URL","createObjectURL","Blob","link","document","createElement","href","setAttribute","body","appendChild","click","remove","revokeObjectURL","alert","className","children","_jsxFileName","lineNumber","columnNumber","patient","prenom","nom","onDownload","_c","$RefreshReg$"],"sources":["/home/viviane/TP JIOMEKONG/carnet-frontend/carnet-medical-app/src/pages/PatientArea.jsx"],"sourcesContent":["// src/pages/PatientArea.jsx\nimport React, { useState, useEffect } from 'react';\nimport { useAuth } from '../context/AuthContext';\nimport { fetchPatientDossier, downloadDocument } from '../api/medicalApi';\nimport DossierDetails from '../components/patient/DossierDetails';\n\nconst PatientArea = () => {\n    const { user } = useAuth();\n    const [dossier, setDossier] = useState(null);\n    const [loading, setLoading] = useState(true);\n    const [error, setError] = useState(null);\n\n    useEffect(() => {\n        const loadDossier = async () => {\n            try {\n                const res = await fetchPatientDossier();\n                setDossier(res.data);\n                setLoading(false);\n            } catch (err) {\n                console.error(\"Erreur lors de la récupération du dossier:\", err);\n                setError(\"Impossible de charger le dossier médical.\");\n                setLoading(false);\n            }\n        };\n\n        if (user && user.role === 'patient') {\n            loadDossier();\n        }\n    }, [user]);\n\n    const handleDownload = async (documentId, fileName) => {\n        try {\n            const res = await downloadDocument(documentId);\n            // Crée un lien temporaire pour télécharger le fichier (blob)\n            const url = window.URL.createObjectURL(new Blob([res.data]));\n            const link = document.createElement('a');\n            link.href = url;\n            link.setAttribute('download', fileName);\n            document.body.appendChild(link);\n            link.click();\n            link.remove();\n            window.URL.revokeObjectURL(url);\n\n        } catch (error) {\n            alert(\"Erreur lors du téléchargement du document.\");\n            console.error(\"Erreur de téléchargement:\", error);\n        }\n    };\n\n    if (loading) return <div className=\"page-container\">Chargement du Dossier...</div>;\n    if (error) return <div className=\"page-container alert alert-error\">{error}</div>;\n\n    return (\n        <div className=\"page-container\">\n            <h1>Espace Personnel Patient</h1>\n            <p>Bienvenue, **{dossier?.patient?.prenom} {dossier?.patient?.nom}**.</p>\n\n            {dossier ? (\n                <DossierDetails dossier={dossier} onDownload={handleDownload} />\n            ) : (\n                <div className=\"alert alert-error\">Aucune donnée de dossier disponible.</div>\n            )}\n        </div>\n    );\n};\n\nexport default PatientArea;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}